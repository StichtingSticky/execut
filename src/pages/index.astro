---
import { getEntry } from 'astro:content'

import Layout from '~/layouts/section.astro'

import Button from '~/components/Button.astro'
import Header from '~/components/Header.astro'
import Section from '~/components/Section.astro'

const entry = await getEntry('editions', '2023')

const { id, data } = entry

const { date, programme } = data

const { name, location } = await getEntry('venues', 'de-kom')
  .then(({ data }) => data)

const talks = programme
  .map((slot) =>
    slot.type === 'talk'
      ? slot.activities.filter(({ type }) => type === 'talk').length
      : 0,
  )
  .reduce((acc, a) => acc + a, 0)

const workshops = programme
  .map((slot) =>
    slot.type === 'talk'
      ? slot.activities.filter(({ type }) => type === 'workshop').length
      : 0,
  )
  .reduce((acc, a) => acc + a, 0)

const summary = {
  speakers: {
    figure: talks,
    href: '/programme',
  },
  workshops: {
    figure: workshops,
    href: '/programme',
  },
  venue: {
    figure: name,
    href: '/venue',
  },
  location: {
    figure: location,
    href: '/venue',
  },
}
---

<Layout edition={id} {date} venue={name}>
  <Header>
    <h1 class="my-6 font-mono text-5xl font-bold text-red sm:mt-48 sm:text-6xl sm:leading-snug">
      A conference for and by IT students.
    </h1>

    <h2 class="my-2 text-2xl leading-snug text-red/80 sm:text-3xl sm:leading-normal">
      For those willing to look further than their own classroom. We want to
      work together, inspire each other, and commit ourselves to a better
      tomorrow. Besides a range of interesting talks exec(ut) provides great
      networking opportunities to those attending.
    </h2>

    <Button as="a" class="p-4 mt-4 text-xl leading-10" href={`https://pretix.svsticky.nl/execut/${id}`}>
      Get your ticket!
    </Button>
  </Header>

  <Section>
    <figure class="grid grid-cols-2 grid-rows-2 my-4 gap-x-2 gap-y-4 sm:gap-6 sm:my-8">
      {Object.entries(summary).map(([title, { figure, href }]) => (
        <a class="sm:text-center" {href}>
          <small class="font-mono text-sm leading-none text-light-red">{title}</small>
          <p class="mt-2 text-xl font-bold text-brown">{figure}</p>
        </a>
      ))}
    </figure>
  </Section>
</Layout>
